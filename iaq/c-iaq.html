<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "HTTP://WWW.W3.ORG/TR/REC-HTML40/STRICT.DTD">
<HTML>

	<HEAD>
		<TITLE>Infrequently Asked Questions in comp.lang.c</TITLE>
	</HEAD>

	<BODY>
		<H4>Meta: [<A HREF="c-iaq-a.html#meta">a</A>]</H4>
		<P>The HTML version of this list is now considered the master version;
		the text version may be updated occasionally, but is now obsolete.
		Additionally, there are now accompanying <A HREF="c-iaq-a.html#meta">annotations</A> for some of the material. (Eventually, for all of the material.)
		Annotations are denoted by a bracketed letter a, or occasionally
		by links in the document text.</P>
		
<P>[Last modified April 16, 1999 by seebs.] [Revision: yes] </P>
<P>[Copyright 1995, 1996, 1997, 1998, 1999 Peter Seebach. All rights reserved, 
  all wrongs reversed. Unauthorized duplication and distribution prohibited.] 
</P>
		<P>The following FAQ has been a hobby of mine since 1995. If you
		enjoy it, please consider sending a token donation to help pay
		for my web page, and help me fund future, similar works. (Yes,
		I am thinking about doing others.) Email <A HREF="mailto:seebs@plethora.net">seebs@plethora.net</A> for information. </P>
		<H4>Introduction: [<A HREF="c-iaq-a.html#intro">a</A>]</H4>
		<P>Certain topics never (well, hardly ever) come up on this newsgroup.
		They are stupid questions, to which the answers are immediately
		obvious, but they would be more fun to talk about than these arcane
		details of loop control. </P>
		<P>This article, which is posted yearly, attempts to answer these
		questions definitively, succinctly, and in such a way as to discourage
		further discussion. </P>
		<H4>Table of Contents:</H4>
		<P><A HREF="#section-1">1. Declarations and Initializations</A><BR>
		<A HREF="#section-2">2. Structures, Unions, and Enumerations</A><BR>
		<A HREF="#section-3">3. Expressions</A><BR>
		<A HREF="#section-4">4. Null Statements</A><BR>
		<A HREF="#section-5">5. Arrays and Pointers</A><BR>
		<A HREF="#section-6">6. Memory Allocation</A><BR>
		<A HREF="#section-7">7. Characters and Strings</A><BR>
		<A HREF="#section-8">8. Boolean Expressions and Variables</A><BR>
		<A HREF="#section-9">9. C Preprocessor</A><BR>
		<A HREF="#section-10">10. ANSI/ISO Standard C</A><BR>
		<A HREF="#section-11">11. Stdio</A><BR>
		<A HREF="#section-12">12. Library Functions</A><BR>
		<A HREF="#section-13">13. Floating Point</A><BR>
		<A HREF="#section-14">14. Variable-Length Argument Lists</A><BR>
		<A HREF="#section-15">15. Lint</A><BR>
		<A HREF="#section-16">16. Strange Problems</A><BR>
		<A HREF="#section-17">17. Style</A><BR>
		<A HREF="#section-18">18. System Dependencies</A><BR>
		<A HREF="#section-19">19. Miscellaneous</A><BR>
		</P>
		<P>Herewith, some infrequently-asked questions and their answers:
		</P>
		<H3><A NAME="section-1"></A>Section 1: Declarations and Initializations [<A HREF="c-iaq-a.html#section-1">a</A>]</H3>
		<H4><A NAME="question-1.1"></A>1.1: How do you decide which integer type to use?</H4>
		<P>Use ``short'' when you need to avoid values over 32,767, ``int''
		when you want to store integers, ``long'' for long numbers (more
		than 6 digits), and ``float'' for numbers over 4 billion. </P>
		<H4><A NAME="question-1.2"></A>1.2: What should the 64-bit type on new, 64-bit machines be?</H4>
		<P>int. </P>
		<H4><A NAME="question-1.3"></A>1.3: If I write the code <CODE>int i, j;</CODE> can I assume that <CODE>(&amp;i + 1) == &amp;j</CODE>?</H4>
		<P>Only sometimes. It's not portable, because in EBCDIC, i and j
		are not adjacent. [<A HREF="c-iaq-a.html#question-1.3">a</A>]</P>
		<H4><A NAME="question-1.4"></A>1.4: What's the best way to declare and define global variables?</H4>
		<P>In headers; this way, you can get link errors when you include
		the same header twice. Generally, you will have to define a variable
		everywhere you want to use it, and then declare it someplace so
		you know what it is. [<A HREF="c-iaq-a.html#question-1.4">a</A>]</P>
		<H4><A NAME="question-1.5"></A>1.5: What does extern mean in a function declaration?</H4>
		<P>It refers to a variable which is not actually in your program.
		For instance, </P>
		<PRE>main() {
	extern int bar;
	printf(&quot;%d\n&quot;, bar);
	return 0;
}</PRE>
		<P>will compile without errors because bar is declared as being external.
		(It won't run, though, because you never assign bar a value.)
		[<A HREF="c-iaq-a.html#question-1.5">a</A>]</P>
		<H4><A NAME="question-1.6"></A>1.6: I finally figured out the syntax for declaring pointers to
		functions, but now how do I initialize one?</H4>
		<P>With the assignment operator. You were perhaps expecting a screwdriver?
		</P>
		<H4><A NAME="question-1.7"></A>1.7: I've seen different methods used for calling through pointers
		to functions. What's the story?</H4>
		<P>In the old days, when Microsoft first invented C, the syntax for
		calling functions involved more parentheses; this was after their
		market research indicated that most C programmers would be coming
		from a Lisp environment. Later, when Kernighan took over the language
		design (right after AT&amp;T bought Microsoft's language technology),
		he decided to eliminate the parentheses, but the old form is still
		allowed. </P>
		<P>You do need the parentheses to call a function with more than
		one argument, for instance, </P>
		<PRE>int (*foo)(char *, ...) = printf;
(*foo)(&quot;hello, %s\n&quot;, &quot;world!&quot;);</PRE>
		<P>needs the parens, but they would not be needed for </P>
		<PRE>foo, &quot;hello, world!\n&quot;;</PRE>
		<P>(The ``*'' just means to execute foo, just like the ``*'' on the
		end of an executable filename in ``ls -F''.) [<A HREF="c-iaq-a.html#question-1.7">a</A>]</P>
		<H4><A NAME="question-1.8"></A>1.8: What's the <CODE>auto</CODE> keyword good for?</H4>
		
<P>Declaring vehicles.</P>
		<H4><A NAME="question-1.9"></A>1.9: I can't seem to define a linked list successfully. I tried</H4>
		<PRE>	typedef struct {
		char *item;
		NODEPTR next;
	} *NODEPTR;</PRE>
		<P>but the compiler gave me error messages. Can't a structure in
		C contain a pointer to itself? </P>
		<P>Not exactly; it can contain a pointer to another structure of
		the same type. Try: </P>
		<PRE>typedef struct {
	char *item;
	double *next;
} NODEFAKE;</PRE>
		<PRE>typedef struct {
	char *item;
	NODEFAKE *next;
} NODEPTR;</PRE>
		<P>Make sure that sizeof(NODEPTR) == sizeof(double). </P>
		<P>This technique is called a ``backwards reference''. [<A HREF="c-iaq-a.html#question-1.9">a</A>]</P>
		<H4><A NAME="question-1.10"></A>1.10: How do I enter values using hexadecimal?</H4>
		<P>long ints can be entered using hexadecimal notation; for instance,
		</P>
		<PRE>long int foo = 07;</PRE>
		<P>sets foo to hex 7. [<A HREF="c-iaq-a.html#question-1.10">a</A>]</P>
		<H4><A NAME="question-1.11"></A>1.11: How do I declare an array of N pointers to functions returning
		pointers to functions returning pointers to characters?</H4>
		<P>Well, first you need to know how to declare an array of N items
		of type T - that's </P>
		<PRE>T foo[N];</PRE>
		<P>Now you need to look at how to declare a pointer to function returning
		something, say, an object of type S. That's like this: </P>
		<PRE>S (*bar)();</PRE>
		<P>Now assume that S is ``pointer to function returning pointer to
		char''. We get </P>
		<PRE>(char *) (*)() (*bar)().</PRE>
		<P>So, the whole thing turns out to be (with appropriate parentheses)
		</P>
		<PRE>(((char)(*))((*)())(((*)((foo)))())([(N)]));</PRE>
		<P>If your compiler complains, break this down into subexpressions.
		</P>
		<P>To call it, just use </P>
		<PRE>foo[i]();</PRE>
		<P>This works because, in C, declaration reflects use, but it's one
		of those weird distorted mirrors. [<A HREF="c-iaq-a.html#question-1.11">a</A>]</P>
		<H3><A NAME="section-2"></A>Section 2: Structures, Unions, and Enumerations [<A HREF="c-iaq-a.html#section-2">a</A>]</H3>
		<H4><A NAME="question-2.1"></A>2.1: What is the difference between an <CODE>enum</CODE> and a series of preprocessor <CODE>#define</CODE>s?</H4>
		<P>The <CODE>enum</CODE> doesn't require the preprocessor. </P>
		<H4><A NAME="question-2.2"></A>2.2: I heard that structures could be assigned to variables and
		passed to and from functions, but <CITE>K&amp;R I</CITE> says not.</H4>
		<P><CITE>K&amp;R I</CITE> was wrong; they hadn't actually learned C very well before writing
		the book. Later, Ritchie got a job at Bell Labs, and worked closely
		with the authors of C, allowing the 2nd edition of the book to
		be much more accurate. (Kernighan already worked at Bell Labs,
		as a video game developer.) [<A HREF="c-iaq-a.html#question-2.2">a</A>]</P>
		<H4><A NAME="question-2.3"></A>2.3: How does struct passing and returning work? </H4>
		<P>The structures are put into the low part of the VGA card's VRAM.
		They are then removed before the next video update. This is why
		struct passing was not supported for a long time; VGA cards were
		prohibitively expensive. </P>
		<P>If you try to pass very large structures on the stack, you may
		see odd screen graphics. [<A HREF="c-iaq-a.html#question-2.3">a</A>]</P>
		<H4><A NAME="question-2.4"></A>2.4: Why can't you compare structs?</H4>
		<P>Compare them to what? A summer's day? </P>
		<H4><A NAME="question-2.5"></A>2.5: How can I read/write structs from/to data files?</H4>
		<P>Loop with <CODE>putchar</CODE>. Be careful; if your machine uses signed chars by default, all
		of the sign bits in your structure elements will be reversed.
		[<A HREF="c-iaq-a.html#question-2.5">a</A>]</P>
		<H4><A NAME="question-2.6"></A>2.6: How can I determine the byte offset of a field within a structure?</H4>
		<P>It's generally 4 times the number of members of the structure.
		It may be more or less on some machines. [<A HREF="c-iaq-a.html#question-2.6">a</A>]</P>
		<H4><A NAME="question-2.7"></A>2.7: How can I access structure fields by name at run time? </H4>
		<P>foo.&quot;name&quot; should work. You may need to overload the . operator,
		which, in turn, may overload your C compiler. </P>
		<H4><A NAME="question-2.8"></A>2.8: Why does sizeof report a larger size than I expect for a
		structure type, as if there was padding at the end? </H4>
		<P>Because there's padding at the end. <STRONG>Duh</STRONG>. </P>
		<H4><A NAME="question-2.9"></A>2.9: My compiler is leaving holes in structures, which is wasting
		space and preventing ``binary'' I/O to external data files. Can
		I turn off the padding, or otherwise control the alignment of
		structs? </H4>
		<P>Sure. What you do to eliminate the padding in structures is use
		unions; for intance, </P>
		<PRE>struct foo {
	char c;
	long l;
	char d;
	char e;
	char f;
};</PRE>
		<P>may cause struct foo to be padded to 12 bytes, rather than the
		correct size of 8. Try </P>
		<PRE>union foo {
	double _d;
	char c, d, e, f;
	long l;
};</PRE>
		<P>which will be 8 bytes. (The double is for alignment.) [<A HREF="c-iaq-a.html#question-2.9">a</A>]</P>
		<H4><A NAME="question-2.10"></A>2.10: Can I initialize unions? </H4>
		<P>Depends. They may go on strike when provoked. Luckily, if your
		program involves air traffic control, the ISO standard guarantees
		that Ronald Reagan will fire any unions that go on strike, and
		replace them with structs, which should be close enough. [<A HREF="c-iaq-a.html#question-2.10">a</A>]</P>
		<H4><A NAME="question-2.11"></A>2.11: How can I pass constant values to routines which accept
		struct arguments? </H4>
		<P>Try foo((struct foo) 3). [<A HREF="c-iaq-a.html#question-2.11">a</A>]</P>
		<H3><A NAME="section-3"></A>Section 3: Expressions [<A HREF="c-iaq-a.html#section-3">a</A>]</H3>
		<H4><A NAME="question-3.1"></A>3.1: Why doesn't the code <CODE>a[i] = i++;</CODE> work? </H4>
		<P>You didn't declare either i or a. </P>
		<H4><A NAME="question-3.2"></A>3.2: Under my compiler, the code </H4>
		<PRE>	int i = 7;
	printf(&quot;%d\n&quot;, i++ * i++);</PRE>
		<P>prints 49. Regardless of the order of evaluation, shouldn't it
		print 56? </P>
		<P>No. The only logical answer would be 81 - two postfix ++'s are
		automatically converted to prefix. </P>
		<H4><A NAME="question-3.3"></A>3.3: I've experimented with the code </H4>
		<PRE>	int i = 2;
	i = i++;</PRE>
		<H4>on several compilers. Some gave i the value 2, some gave 3, but
		one gave 4. I know the behavior is undefined, but how could it
		give 4? </H4>
		<P>Because i is 2, the loop is executed twice. </P>
		<H4><A NAME="question-3.4"></A>3.4: People keep saying the behavior is undefined, but I just
		tried it on an ANSI-conforming compiler, and got the results I
		expected. </H4>
		<P>They were probably wrong. Flame them mercilessly. Be sure before
		you do that your compiler is <EM>really</EM> ANSI conforming, though. If it turns out you were wrong, they
		get a legal claim on your first-born. </P>
		<H4><A NAME="question-3.5"></A>3.5: Can I use explicit parentheses to force the order of evaluation
		I want? Even if I don't, doesn't precedence dictate it? </H4>
		<P>No. To force order of evaluation, you must threaten it. Take the
		comma operator hostage. Using it, you can force the other operators
		to do what you want. [<A HREF="c-iaq-a.html#question-3.5">a</A>]</P>
		<H4><A NAME="question-3.6"></A>3.6: But what about the <CODE>&amp;&amp;</CODE>, <CODE>||</CODE>, and comma operators? I see code like ``<CODE>if((c = getchar()) == EOF || c == '\n')</CODE>'' ... </H4>
		<P>As noted, once you've captured the comma operator, the others
		become docile. </P>
		<H4><A NAME="question-3.7"></A>3.7: If I'm not using the value of the expression, should I use
		<CODE>i++</CODE> or <CODE>++i</CODE> to increment a variable? </H4>
		<P><CODE>++i</CODE>. Only losers and idiots use <CODE>i++</CODE>. This is different if your native language would idiomatically
		use ``i increment'', but in English and related languages, you
		must use <CODE>++i</CODE>. Note that a modern program must use both, dependent on the current
		locale. </P>
		<H4><A NAME="question-3.8"></A>3.8: Why is <CODE>i = ++i</CODE> undefined? </H4>
		<P>Because it is unclear whether it is shorthand for <CODE>i = 42;</CODE> or <CODE>i = (char *) &quot;forty two&quot;;</CODE>. </P>
		<P>Given the ambiguity, the standards committee decided to leave
		it undefined. </P>
		<H3><A NAME="section-4"></A>Section 4: Null Statements [a]</H3>
		<H4><A NAME="question-4.1"></A>4.1: What is this infamous null statement, anyway? </H4>
		<P>A null statement is an expression statement consisting solely
		of the terminating semicolon. The optional expression is dropped.
		It can be distinguished from any other statement by byte count
		or study of side-effects. </P>
		<H4><A NAME="question-4.2"></A>4.2: How do I ``get'' a null statement in my programs? </H4>
		<P>In ANSI C, there are six types of statements; labeled statements,
		compound statements, expression-statements, selection statements,
		iteration statements, and jump statements. All of them, except
		the jump and expression statments, are defined in terms of optional
		preceeding text, and other statements. The jump statements are
		never null statements. An expression statement is considered to
		be ``a null statement'' if the optional expression part of it
		has been left out. A null statement can appear on its own, or
		(most frequently) as the statement body of an iteration statement.
		These two null statements are equivalent, though neither of them
		is equivalent to any non-null statement. [*] </P>
		<P>You may accidentally get a null statement by deleting the body
		of a non-null statement. </P>
		<P>[*] Actually, they are functionally equivalent to a large set
		of non-null statements, namely, those with no side-effects. However,
		the FDA has yet to approve any such, as their lack of side effects
		is conjectured, and not clinically proven. This applies only to
		the ANSI standard, and not the ISO standard, as the FDA has no
		jurisdiction outside the U.S. [<A HREF="c-iaq-a.html#question-4.2">a</A>]</P>
		<H4><A NAME="question-4.3"></A>4.3: Is there more than one null statement?</H4>
		<P>Sort of. You can use ``;'', ``0;'', or ``1;'' - they will all
		act like a null statement. Only the first is a ``true'' null statement
		(all bits zero). They are basically equivalent. Note that (void
		*) 0; is a null statement of type pointer to void, for instance.
		[<A HREF="c-iaq-a.html#question-4.3">a</A>]</P>
		<H4><A NAME="question-4.4"></A>4.4: But I thought <CODE>{ }</CODE> was a null statement!</H4>
		<P>No. <CODE>{ statement-list[opt] }</CODE> is a compound statement. An empty block is not the same as a
		null statement, however, although it can be used in many of the
		same places. It's really a null block. (You can convert it with
		a cast, but it's not directly compatible. For instance, you can't
		use a null block as one of the controlling statements of a for
		loop.) </P>
		<H4><A NAME="question-4.5"></A>4.5: I use the statement <CODE>#define NULLSTMT(F) (F) ;</CODE> to allow me to cast a null statement to an appropriate type.</H4>
		<P>This trick, though popular in some circles, does not buy much.
		The resulting code is invalid, and will not compile. This (in
		the author's opinion) outweighs any arguable type consistency.
		It may be more common in industrial code. If it becomes common
		practice, C++ will probably legalize it. [<A HREF="c-iaq-a.html#question-4.5">a</A>]</P>
		<H4><A NAME="question-4.6"></A>4.6: I use the statement <CODE>#define NULLSTMT(F) (F) 0;</CODE> to allow me to cast a null statement to an appropriate type.</H4>
		<P>This trick will likely work, but think: what does it really buy
		you? Mostly, it will indicate to even the most casual observer
		that you are shakey on the concept of null statements, making
		it harder for them to check your code. </P>
		<H4><A NAME="question-4.7"></A>4.7: But wouldn't it be better to use <CODE>;</CODE> (rather than <CODE>0;</CODE>) in case the value of 0 changes, perhaps on a machine with nonzero
		no-op instructions? </H4>
		
<P>No. The '<CODE>0</CODE>' of '<CODE>0;</CODE>' is not evaluated as an instruction, 
  rather, it is just ignored. The only reason to use '<CODE>0;</CODE>' instead 
  of '<CODE>;</CODE>' is to help keep 1-heavy code properly balanced (in C, which 
  uses binary representations for numbers, it is possible for code to become unbalanced; 
  an unbalanced binary tree is a common source of poor performance.</P>
		<H4><A NAME="question-4.8"></A>4.8: Is a null statement a null pointer? </H4>
		<P>No. A null pointer is a pointer where all of the address bits
		are zero (no matter what the segment bits are), and can be obtained
		by typing '(char *) (int) 0'. A null statement is not a pointer
		to anything. They are not interchangeable, although you can combine
		them to get an effectively-null statement, such as <CODE>NULL;</CODE>. This does not buy you anything. [<A HREF="c-iaq-a.html#question-4.8">a</A>]</P>
		<H4><A NAME="question-4.9"></A>4.9: I'm still confused. I just can't understand all this null
		statement stuff. </H4>
		<P>Follow these two simple rules: </P>
		<OL>
			<LI>When you don't want to do anything in source code, don't write
			it. 
			<LI>If you need a null statement to round out an expression, use an
			unadorned <CODE>;</CODE> to provide it. 
			<LI>Send large donations, checks, and money orders to the author of
			the FAQ, or the moderator of the group, whichever you prefer.
			Then, cross the top question off the FAQ, answer the question
			at the bottom, and mail it to three people. Within two weeks,
			you will receive 729 answers to various questions! Do not break
			the chain; Emily Postnews broke the chain, and now no one listens
			to her. [<A HREF="c-iaq-a.html#question-4.9">a</A>] 
		</OL>
		<H3><A NAME="section-5"></A>Section 5: Arrays and Pointers</H3>
		<H4><A NAME="question-5.1"></A>5.1: I had the definition <CODE>char a[6]</CODE> in one source file, and in another I declared <CODE>extern char a[]</CODE>. Why did it work?</H4>
		<P>The declaration <CODE>extern char a[]</CODE> simply matches the actual definition. The type ``array-of-type-T''
		is the same as ``array-of-type-T.'' Go ahead and use <CODE>extern char a[]</CODE>. (For greater portability, use it in both files, not only in
		one of them.) [<A HREF="c-iaq-a.html#question-5.1">a</A>]</P>
		<H4><A NAME="question-5.2"></A>5.2: But I heard that <CODE>char a[]</CODE> was different from <CODE>char a[6]</CODE>.</H4>
		<P>This is true. However, the declaration <CODE>a[]</CODE> is compatible with the definition <CODE>a[6]</CODE>.</P>
		<H4><A NAME="question-5.3"></A>5.3: So what is meant by the ``equivalence of pointers and arrays''
		in C?</H4>
		<P>Very little.</P>
		<H4><A NAME="question-5.4"></A>5.4: Then why are array and pointer declarations interchangeable
		as function formal parameters?</H4>
		<P>Classism. We consider arrays ``second class objects''. They don't
		vote, and they get treated as pointers. Additionally, they're
		merely objects, not citizens. Marx wrote about this a lot. [<A HREF="c-iaq-a.html#question-5.4">a</A>]</P>
		<H4><A NAME="question-5.5"></A>5.5: Why doesn't sizeof properly report the size of an array which
		is a parameter to a function? </H4>
		<P>Part of the ANSI conspiracy to restrict people to passing pointers;
		this was undertaken after the first discovery that passing large
		arrays recursively could cause crashes. Since then, with the passing
		of MS-DOS, it has become a non-issue; since all serious machines
		have virtual memory, you can pass as much data as you want on
		the stack without detectable problems. [<A HREF="c-iaq-a.html#question-5.5">a</A>]</P>
		<H4><A NAME="question-5.6"></A>5.6: Someone explained to me that arrays were really just constant
		pointers. </H4>
		<P>Cool. Someone I know says he saw Elvis in a local bar. [<A HREF="c-iaq-a.html#question-5.6">a</A>]</P>
		<H4><A NAME="question-5.7"></A>5.7: Practically speaking, what is the difference between arrays
		and pointers? </H4>
		<P>About the difference between alcohol and marijuana; they have
		different characteristics, and that's not a problem if you don't
		mix them too carelessly. </P>
		<H4><A NAME="question-5.8"></A>5.8: I came across some ``joke'' code containing the ``expression''
		<CODE>5[&quot;abcdef&quot;]</CODE>. How can this be legal C? </H4>
<P>It was added to allow people to avoid the character constant 'f' which may 
  not be available on some systems. (Actually, it's a side-effect of the equivalence 
  of arrays and pointers.) [<A HREF="c-iaq-a.html#question-5.8">a</A>]</P>
		<H4><A NAME="question-5.9"></A>5.9: How would I initialize an entire array from standard input?
		</H4>
		<P>You have to use a loop. For instance, the following code reads
		the numbers zero through 99 into the array a. </P>
		<PRE>for (i = 0; i &lt; 100; ++i)
	a[i] = (scanf, (&quot;%d&quot;, i));</PRE>
		<P>Make sure to include <CODE>&lt;stdio.h&gt;</CODE>, or this may not work. [<A HREF="c-iaq-a.html#question-5.9">a</A>]</P>
		<H3><A NAME="section-6"></A>Section 6: Memory Allocation</H3>
		<H4><A NAME="question-6.1"></A>6.1: Why doesn't this fragment work? </H4>
		<PRE>	char *answer
	printf(&quot;Type something:\n&quot;);
	gets(answer);
	printf(&quot;You typed \&quot;%s\&quot;\n&quot;, answer);</PRE>
<P>The semicolon after ``answer'' is missing. [<a href="c-iaq-a.html#question-6.1">a</a>]</P>
		<H4><A NAME="question-6.2"></A>6.2: I have a function that is supposed to return a string, but
		when it returns to its caller, the returned string is garbage.
		</H4>
		<P>You probably returned a pointer to a local array. That doesn't
		work. Try using a temporary file, instead. For instance: </P>
		<PRE>char *getstr(void) {
	FILE *fp = tmpfile();
	fputs(gets(NULL), fp);
	return (char *) fp;
}</PRE>
		<H4><A NAME="question-6.3"></A>6.3: Why does some code carefully cast the values returned by
		malloc to the pointer type being allocated? </H4>
		
<P>In interrupt-riddled code, it may be necessary to cast values to force the 
  CPU to resolve pointer types. [<a href="c-iaq-a.html#question-6.3">a</a>]</P>
		<H4><A NAME="question-6.4"></A>6.4: You can't use dynamically-allocated memory after you free
		it, can you? </H4>
		<P>Yes. However, what happens when you do is not clearly defined.
		</P>
		<H4><A NAME="question-6.5"></A>6.5: How does free() know how many bytes to free? </H4>
		
<P>Interrupt 41h. On macs, amigas, and other ``big-endian'' processors, that would 
  be interrupt 14h; be wary of portability problems. [<a href="c-iaq-a.html#question-6.5">a</a>]</P>
		<H4><A NAME="question-6.6"></A>6.6: So can I query the malloc package to find out how big an
		allocated block is? </H4>
		<P>Not exactly; because the objects are dynamically allocated, their
		size can change at run time, so this will not be reliable. If
		you restrict your allocation to allocating sizeof(void *) bytes
		at a time, you will find that you can use sizeof() to get the
		size of a block, in the obvious way. </P>
		<H4><A NAME="question-6.7"></A>6.7: I'm allocating structures which contain pointers to other
		dynamically-allocated objects. When I free a structure, do I have
		to free each subsidiary pointer first? </H4>
		<P>No. You just have to keep track of them somewhere else also. </P>
		<H4><A NAME="question-6.8"></A>6.8: Was Proust's masterwork, <CITE>A Remembrance of Things Past</CITE>, the basis for the C library's allocation scheme, based largely
		on contextual analysis? </H4>
		<P>The standard does not specify an allocation scheme; the famous
		author the allocation scheme is based on is implementation specified.
		Proust is a common choice, however. </P>
		<H4><A NAME="question-6.9"></A>6.9: I have a program which mallocs but then frees a lot of memory,
		but memory usage (as reported by ps) doesn't seem to go back down.
		</H4>
		<P>You're probably not freeing the memory completely. Try replacing
		'<CODE>free(foo);</CODE>' with</P>
		<PRE>free(foo);
free(foo);
free(foo);</PRE>
		
<P>in case the first <code>free()</code> frees the memory only partially. (Unix 
  wizards may recognize the parallel with syncing three times before rebooting.) 
</P>
		<P>Alternatively, free(foo) + 4; may free the remaining four bytes.
		(Before using this, make sure realloc(foo, 0) returned 4). </P>
		<H3><A NAME="section-7"></A>Section 7: Characters and Strings</H3>
		<H4><A NAME="question-7.1"></A>7.1: How can I get the numeric (character set) value corresponding
		to a character, or vice versa? </H4>
		<P>The obvious way is to write a function to do the conversion. (Error
		checking has been omitted for brevity.) </P>
		<PRE>int ctoi(char c) {
	static unsigned char *ary;
	/* initialize the array */
	if (!ary) {
		int i;

		ary = malloc(UCHAR_MAX + 2);
		for (i = 0; i &lt; UCHAR_MAX + 1; ++i) {
			ary[i] = i;
		}
		ary[UCHAR_MAX + 1] = '\0';
	}
	if (c) {
		unsigned char *t;

		/* we have to skip the leading NUL */
		t = strchr(ary + 1, c);
		if (!t)
			return 0;
		return t - ary;
	} else {
		/* special case for NUL character */
		return 0;
	}
}</PRE>
<P>There are various clever tricks you can use to get around writing the function, 
  but most are too complicated for beginners. [<a href="c-iaq-a.html#question-7.1">a</a>]</P>
		<H3><A NAME="section-8"></A>Section 8: Boolean Expressions and Variables</H3>
		<H4><A NAME="question-8.1"></A>8.1: What is the right type to use for boolean values in C? Why
		isn't it a standard type? Should <CODE>#define</CODE>s or <CODE>enum</CODE>s be used for the true and false values? </H4>
		<P><CODE>int (*)(int, char **)</CODE> makes a good boolean type. You can use <CODE>main</CODE> for true, and <CODE>exit</CODE> for false. On some compilers, you may need to cast <CODE>exit()</CODE> to an appropriate type. </P>
		<H4><A NAME="question-8.2"></A>8.2: Isn't <CODE>#defining</CODE> TRUE to be 1 dangerous, since any nonzero value is considered
		``true'' in C? What if a built-in boolean or relational operator
		``returns'' something other than 1? </H4>
		<P>Very good! For instance, one program I saw used </P>
		<PRE>#define TRUE(x) ((x) &amp; 0x100)</PRE>
		<P>for compatability with a specific release of a FORTRAN compiler,
		which used 0 for .FALSE. and 256 for .TRUE. - this allowed them
		to change their code with every new release of the FORTRAN compiler,
		and kept them alert to changes. This has no relationship to the
		boolean or logical operators in C, which always return 0 or 1.
		</P>
		<H4><A NAME="question-8.3"></A>8.3: What is truth? </H4>
		
<P>It is not a saffron-robed monk, pissing in the snow. [<a href="c-iaq-a.html#question-8.3">a</a>]</P>
		<H3><A NAME="section-9"></A>Section 9: C Preprocessor</H3>
		<H4><A NAME="question-9.1"></A>9.1: How can I use a preprocessor <CODE>#if</CODE> expression to tell if a machine is big-endian or little-endian?
		</H4>
		
<P><CODE>#ifdef __BIG_ENDIAN</CODE> should work on all known machines; Borland 
  defines it. [<a href="c-iaq-a.html#question-9.1">a</a>]</P>
		<H4><A NAME="question-9.2"></A>9.2: I've got this tricky processing I want to do at compile time
		and I can't figure out a way to get cpp to do it. </H4>
		<P>Poor baby. </P>
		<H4><A NAME="question-9.3"></A>9.3: How can I list all of the pre-<CODE>#define</CODE>d identifiers? </H4>
		<P><CODE>#define __ALL_CPP_IDS</CODE> - put this in a source file, and run it through your C preprocessor.
		</P>
		<H4><A NAME="question-9.4"></A>9.4: How can I write a cpp macro which takes a variable number
		of arguments? </H4>
		<P>Try something like this: </P>
		<PRE>

#define add(x) (x)
#define add(x, y) (x + y)
#pragma induction add</PRE>
		<H4><A NAME="question-9.5"></A>9.5: Shouldn't the following code: </H4>
		<PRE>

	#define ROSE 1
	#define CHRYSANTHEMUM 2
	#define RHODODENDRON 3
	#define WATER_LILY 4
	printf(&quot;%d\n&quot;, CHRYSATHNEMUM);</PRE>
		<P>print ``2''? </P>
		<P>You misspelled CHRYSANTHEMUM. Use abbreviations for long flower
		names in C code. </P>
		<H3><A NAME="section-10"></A>Section 10: ANSI C</H3>
		<H4><A NAME="question-10.1"></A>10.1: What is the ``ANSI C Standard?'' </H4>
		
<P>A whiny bunch of lusers who haven't written as many books as Herbert Schildt. 
  [<a href="c-iaq-a.html#question-10.1">a</a>]</P>
		<H4><A NAME="question-10.2"></A>10.2: How can I get a copy of the Standard? </H4>
		<P>
		Use a copier. 
		<H4><A NAME="question-10.3"></A>10.3: Does anyone have a tool for converting old-style C programs
		to ANSI C, or vice versa, or for automatically generating prototypes?
		</H4>
		<P>A router helps, but your best bet is still the band saw. Quick,
		efficient, and powerful. </P>
		<H4><A NAME="question-10.4"></A>10.4: I'm trying to use the ANSI ``stringizing'' preprocessing
		operator <CODE>#</CODE> to insert the value of a symbolic constant into a message, but
		it keeps stringizing the macro's name rather than its value. </H4>
		<P>This is because <CODE>&quot;3&quot;</CODE> is not a legal integral constant in C - it's a string constant.
		</P>
		<H4><A NAME="question-10.5"></A>10.5: I don't understand why I can't use const values in initializers
		and array dimensions, as in </H4>
		<PRE>

	const int n = 7;
	int a[n];</PRE>
		<P>Because you're not using C++. </P>
		<H4><A NAME="question-10.6"></A>10.6: What's the difference between ``char const *p'' and ``char
		* const p''? </H4>
		<P>One `` '' character. There are some trivial differences having
		to do with the distinction between a pointer to a constant, and
		a constant pointer, but since you can cast either to a (char *)
		it hardly matters. </P>
		<H4><A NAME="question-10.7"></A>10.7: Can I declare main as void, to shut off these annoying ``main
		returns no value'' messages? (I'm calling exit(), so main doesn't
		return.) </H4>
		<P>Certainly. You can also declare it as double. It may not compile,
		or it may crash, but who cares? No lousy bunch of whining lusers
		is going to tell *you* what to do. </P>
		<H4><A NAME="question-10.8"></A>10.8: Why does the ANSI Standard not guarantee more than six monocase
		characters of external identifier significance? </H4>
		
<P>Because none of the members of the committee had names over six letters, or 
  in which letters other than the first were capitalized. [<a href="c-iaq-a.html#question-10.8">a</a>]	
</P>
		<H4><A NAME="question-10.9"></A>10.9: What is the difference between memcpy and memmove? </H4>
		<P>memmove moves memory, and memcpy copies it. memmove may not be
		supported on machines without internal robot arms. Do not use
		memmove while the machine is powered up - you can destroy your
		memory. </P>
		<H4><A NAME="question-10.10"></A>10.10: Why won't the Frobozz Magic C Compiler, which claims to
		be ANSI compliant, accept this code? I know that the code is ANSI,
		because gcc accepts it. </H4>
		
<P>The Frobozz Magic Company lies through its teeth. Consider: does Flood Control 
  Dam #3 actually control floods? Didn't think so. The wands are excellent for 
  making useless via casts of Float, though. [<a href="c-iaq-a.html#question-10.10">a</a>]</P>
		<H4><A NAME="question-10.11"></A>10.11: Why can't I perform arithmetic on a void * pointer? </H4>
		<P>You're too big and clumsy. When you try to push the numbers together,
		you lose your balance. Perhaps you should get some angels from
		the rave over on pin 3. </P>
		<H4><A NAME="question-10.12"></A>10.12: What are #pragmas and what are they good for? </H4>
		<P>They are useful ways to eliminate compiler features which are
		not helpful to your goals; contrast #utility, which introduces
		useful compiler features, and #absolutist, which introduces those
		compiler features believed to be right. #relativist is supported
		by some compilers. </P>
		<H4><A NAME="question-10.13"></A>10.13: What does ``#pragma once'' mean? I found it in some header
		files. </H4>
		
<P>It means that your program will only run once; it's used to create ``crippled 
  demos''. [<a href="c-iaq-a.html#question-10.13">a</a>]</P>
		<H4><A NAME="question-10.14"></A>10.14: People seem to make a point of distinguishing between implementation-defined,
		unspecified, and undefined behavior. What's the difference? </H4>
		<P>There isn't really one; people just enjoy flaming over nits. (To
		be technical, one has a hyphen, one has a space, and one is a
		single word.) </P>
		<H4><A NAME="question-10.15"></A>10.15: Is C an acronym? </H4>
		<P>Yes, it stands for ``C''. It's another of those funky recursive
		acronyms. </P>
		<H3><A NAME="section-11"></A>Section 11: Stdio</H3>
		<H4><A NAME="question-11.1"></A>11.1: What's wrong with this code: </H4>
		<PRE>

	char c;
	while((c = getchar()) != EOF)...</PRE>
		<P>You forgot to include space for the terminating NUL character,
		so the compiler can't find the end of c without overwriting other
		memory. In all probability, after the user types ``n&lt;return&gt;'',
		your code will look like </P>
		
<PRE>
char cn
while((c = getchar()) != EOF)...</PRE>
		<P>which won't compile. </P>
		<P>Also, the ellipsis is not legal outside of function protoypes.
		</P>
		<P>Try </P>
		
<PRE>
char c[2]; /* include space for terminating NUL */
while ((c = getchar()) != EOF)
	;</PRE>
		
<P>Note the use of the null statement to absorb the NUL. (See <A HREF="#section-4">Section 
  4</A>.)</P>
		<H4><A NAME="question-11.2"></A>11.2: How can I print a ``%'' character in a printf format string?
		I tried ``\%'' but it didn't work. </H4>
		<P>Break the '%' sign out. i.e., fprintf(&quot;foo &quot; &quot;%&quot; &quot;%d\n&quot;, foo);
		</P>
		<P>Alternatively, try </P>
		<P>sprintf(&quot;o&quot; &quot;/&quot; &quot;o&quot;) to get a &quot;%&quot;. </P>
		
<P>The astute reader will notice that the latter example uses sprintf, and the 
  former fprintf - this is because sprintf() works by characters, or strings, 
  while fprintf (``fast printf'') works on files. [<a href="c-iaq-a.html#question-11.2">a</a>]</P>
		<H4><A NAME="question-11.3"></A>11.3: Why doesn't the code scanf(&quot;%d&quot;, i); work? </H4>
		<P>You need to do this a bit differently; you should always check
		for the return from scanf, so try something like </P>
		<PRE>

i = 1;
if ((scanf, &quot;%d&quot;, i) == 1)</PRE>
		<P>to make sure you're reading correctly. (The assignment to i is
		so that, if scanf fails, you still have a legal value in i.) </P>
		<H4><A NAME="question-11.4"></A>11.4: Once I've used freopen, how can I get the original stdout
		(or stdin) back? </H4>
		<P>Call main() - the environment will be restored. </P>
		<H4><A NAME="question-11.5"></A>11.5: Why won't the code </H4>
		<PRE>

	while(!feof(infp)) {
		fgets(buf, MAXLINE, infp);
		fputs(buf, outfp);
	}</PRE>
		<H4>work? </H4>
		<P>Because the end of file character is not detected on files named
		``infp''. (Introverted-iNtuitive-Feeling-Perceptive, that is.)
		Also, it may be that the file was opened in text mode, where an
		end of file is read as a capital 'Z' on most machines, and feof()
		only looks for 'control Z'. </P>
		<H4><A NAME="question-11.6"></A>11.6: Why does everyone say not to use gets()? </H4>
		<P>Because they're trying to spoil your fun. gets() can make an otherwise
		droll and predictable program a lot more exciting. </P>
		<H4><A NAME="question-11.7"></A>11.7: Why does errno contain ENOTTY after a call to printf? </H4>
		
<P>Because stdout is not a mammal. [<a href="c-iaq-a.html#question-11.7">a</a>]</P>
		<H4><A NAME="question-11.8"></A>11.8: My program's prompts and intermediate output don't always
		show up on the screen, especially when I pipe the output through
		another program. </H4>
		<P>Have you turned your monitor on? If not, try hitting the ``PrtSc''
		key, which will re-enable the electron guns. </P>
		<H4><A NAME="question-11.9"></A>11.9: How can I read one character at a time, without waiting
		for the RETURN key? </H4>
		
<P>Ask the user to press enter after hitting a single character. [<a href="c-iaq-a.html#question-11.9">a</a>]	
</P>
		
<H4><A NAME="question-11.10"></A>11.10: People keep telling me that <code>getch()</code> 
  is not standard, but my C compiler has it. Are they wrong? </H4>
		<P>They've been programming more than ten years. You haven't. Draw
		your own conclusions. That's right! They hadn't noticed it. No
		doubt their compilers have it too, and its behavior is identical
		everywhere else in the world, also. That would explain everything.
		</P>
		
<H4><A NAME="question-11.11"></A>11.11: What does it matter that <code>getch()</code> 
  isn't standard; it works, doesn't it? </H4>
		<P>Well, that would depend on the definition you're using for ``works''.
		</P>
		
<H4><A NAME="question-11.12"></A>11.12: I tried to port some code from a PC to 
  a unix machine, and now it crashes immediately on startup. It isn't using <code>getch()</code> 
  - it's reading directly from the keyboard. How can this be wrong? </H4>
		<P>The chances are you forgot to run the Unix linker; currently your
		code is linked to your PC hardware, and won't run anywhere else
		until it's linked to the new hardware. It may also need to be
		linked to someone with a brain. </P>
		<H4><A NAME="question-11.13"></A>11.13: How can I redirect stdin or stdout to a file from within
		a program? </H4>
		<P>execlv(&quot;main()&quot; &quot;&gt; file&quot;, argv); </P>
		<H4><A NAME="question-11.14"></A>11.14: How can I recover the file name given an open file descriptor?
		</H4>
		<P>You will have to search the filesystem for files of the same size
		as the file you're reading, and compare information in them to
		find the file you're working on. </P>
		<H4><A NAME="question-11.15"></A>11.15: How do I open Flood Control Dam #3? </H4>
		
<P>PUSH THE YELLOW BUTTON. TURN THE BOLT WITH THE WRENCH. (You must have the wrench, 
  first.) [<a href="c-iaq-a.html#question-11.15">a</a>]</P>
		<H3><A NAME="section-12"></A>Section 12: Library Subroutines</H3>
		<H4><A NAME="question-12.1"></A>12.1: How can I convert numbers to strings (the opposite of atoi)?
		Is there an itoa function? </H4>
		<P>There's frequently an itoa function. Better yet, write your own;
		it'll be good practice. On some implementations, (char *) x; will
		convert x to a string. </P>
		<H4><A NAME="question-12.2"></A>12.2: How can I get the current date or time of day in a C program?
		</H4>
		<P>fprintf(stderr, &quot;please enter the current time and date...&quot;);
		fflush(stderr); gets(stdin); </P>
		<H4><A NAME="question-12.3"></A>12.3: I need a random number generator. </H4>
		<P>Count errors in Herbert Schildt's C books. No one has detected
		any consistent pattern. </P>
		<H4><A NAME="question-12.4"></A>12.4: How can I get random integers in a certain range? </H4>
		<P>random(n) returns random numbers between n and INT_MAX. </P>
		<H4><A NAME="question-12.5"></A>12.5: Each time I run my program, I get the same sequence of numbers
		back from rand(). </H4>
		<P>This is so your results will be reproducible. </P>
		<H4><A NAME="question-12.6"></A>12.6: I need a random true/false value, so I'm taking rand() %
		2, but it's just alternating 0, 1, 0, 1, 0... </H4>
		<P>That seems pretty random to me. </P>
		<H4><A NAME="question-12.7"></A>12.7: I need some code to do regular expression matching. </H4>
		<P>So do I. Let me know if you find some. </P>
		<H4><A NAME="question-12.8"></A>12.8: I read through the standard library, but there's no function
		to multiply two floating point numbers! Help! </H4>
		<P>Many C compilers offer an extension ``mult'' to do just this.
		If your compiler doesn't, just hang tight; ANSI is likely to add
		it in the next revision. </P>
		<P>For now, you can try </P>
		
<PRE>
float mult(float m, n)
{
	float i = 0, j = 0;
	for (i = 0; i &lt; n; ++i)
		j += m;
	return j;
}</PRE>
		<P>which is fine as long as n is an integer. </P>
		<H4><A NAME="question-12.9"></A>12.9: How do I get past the snake? </H4>
		
<P>Release the bird. You will have to drop the rod to get the bird in the cage. 
  [<a href="c-iaq-a.html#question-12.9">a</a>]</P>
		<H3><A NAME="section-13"></A>Section 13: Floating Point</H3>
		<H4><A NAME="question-13.1"></A>13.1: My floating-point calculations are acting strangely and
		giving me different answers on different machines. </H4>
		
<P>One of the machines is probably a Pentium. Scrap it and get a real machine. 
  [<a href="c-iaq-a.html#question-13.1">a</a>]</P>
		<H4><A NAME="question-13.2"></A>13.2: I'm trying to do some simple trig, and I am #including &lt;math.h&gt;,
		but I keep getting ``undefined: _sin'' compilation errors. </H4>
		<P>You forgot to define the sin() function. Most math texts should
		cover it in some detail. The easiest way to fix this should be:
		</P>
		
<PRE>
double sin(double x) {
	return sqrt(1 - cos(x) * cos(x));
}</PRE>
		<P>Warning: You <EM>must not</EM> declare this function as ``extern'', or you will still have link
		problems. </P>
		<H4><A NAME="question-13.3"></A>13.3: Why doesn't C have an exponentiation operator? </H4>
		<P>It does. It looks like the multiplication operator, but you use
		it more. For instance, the C way of expressing ``x squared'' is
		``x*x''. ``x cubed'' would be ``x*x*x''. Easy, isn't it? </P>
		<H4><A NAME="question-13.4"></A>13.4: How do I round numbers? </H4>
		<P>Multiply by 10. <CITE>Numerical Recipies in C</CITE> has a section on this, but there's reputedly a bug in their algorithm.
		</P>
		<H4><A NAME="question-13.5"></A>13.5: How do I test for IEEE NaN and other special values? </H4>
		<P>Using an electron microscope; the patterns are obvious once you
		know them. </P>
		<H4><A NAME="question-13.6"></A>13.6: I'm having trouble with a Turbo C program which crashes
		and says something like ``floating point formats not linked.''
		</H4>
		<P>Turbo C is notoriously buggy. Get a compiler with floating point
		support. </P>
		<H4><A NAME="question-13.7"></A>13.7: What is so ``unsafe'' about floating point? </H4>
		<P>Have you tried <CODE>EXAMINE STICK</CODE>? The stick has a sharp point, which punctures the raft, which
		no longer floats. Don't bring the stick into the raft with you.
		</P>
		<H4><A NAME="question-13.8"></A>13.8: Which is larger, ``2'' or ``2.0''? </H4>
		<P><CITE>Numerical Recipes in C</CITE> has a function for comparing two values to see which is greater.
		It may have a slight bug, where it would report incorrect results
		if the numbers differ by less than FLOAT_MAX / INT_MAX. </P>
		<H4><A NAME="question-13.9"></A>13.9: When I try to compile the following code, I get the error
		``invalid use of floating point'', what does this mean? </H4>
		<PRE>

	x=663608941*y%pow(2,32);</PRE>
		<P>Remember that * is the indirection operator, as well as the multiplication
		operator; try putting spaces before and after the ``*'' so the
		compiler knows what you mean. Do the same with the % operator.
		</P>
		<H4><A NAME="question-13.10"></A>13.10: How can I copy a float into a string? </H4>
		<P>strcpy(string_var, float_var); </P>
		<H4><A NAME="question-13.11"></A>13.11: What are float variables, anyway? </H4>
		<P>The term ``float variable'' is actually redundant; they are simply
		variables whose value can ``float'' during execution. For instance:
		</P>
		
<PRE>
float f, g = 3;
f = g; /* f ``floats'' to g */</PRE>
		
<P>Easy! </P>
		<H3><A NAME="section-14"></A>Section 14: Variable-Length Argument Lists</H3>
		<H4><A NAME="question-14.1"></A>14.1: How can I write a function that takes a variable number
		of arguments? </H4>
		<P>By declaring it with a variable number of arguments in the prototype.
		Use only the arguments declared at any given time. </P>
		<H4><A NAME="question-14.2"></A>14.2: How can I write a function that takes a format string and
		a variable number of arguments, like printf, and passes them to
		printf to do most of the work? </H4>
		<P>Redefine printf; the call to ``printf'' inside yours will be resolved
		to the library version, because the C language doesn't allow recursion.
		</P>
		<H4><A NAME="question-14.3"></A>14.3: How can I discover how many arguments a function was actually
		called with? </H4>
		<P>_args is an external integer constant. It evaluates to three times
		the number of arguments the current function was called with.
		You can then look at _argdata[args] to get the address of the
		last arg, _argdata[args - 1] to get the size of the last arg,
		and _argdata[args - 2] to get the type of the last arg (as an
		int). </P>
		<P>N.B. You *MUST* not refer to _args or _argdata between the ()'s
		of a function call; their value will be indeterminate. Use temporary
		storage. </P>
		<H4><A NAME="question-14.4"></A>14.4: Why doesn't </H4>
		
<PRE>
	printf(&quot;hello, &quot;, &quot;world!&quot;, '\n');</PRE>
		<H4>work? I thought printf() took a variable number of arguments.
		</H4>
		<P>It will probably work some of the time; the number of arguments
		used by printf() may vary, as it is a variadic function. </P>
		<H3><A NAME="section-15"></A>Section 15: Lint</H3>
		<H4><A NAME="question-15.1"></A>15.1: I just typed in this program, and it's acting strangely.
		Can you see anything wrong with it? </H4>
		<P>Yes. There's too much lint in it. You should get a shop vac. </P>
		<H4><A NAME="question-15.2"></A>15.2: How can I shut off the ``warning: possible pointer alignment
		problem'' message lint gives me for each call to malloc? </H4>
		<P>Don't run lint. Alternatively, provide a prototype of ``extern
		double * malloc()'' to make the return from malloc() be more strongly
		aligned. </P>
		<H4><A NAME="question-15.3"></A>15.3: Where can I get an ANSI-compatible lint? </H4>
		<P>You may wish to check your spouse's navel occasionally, especially
		if your spouse works for a standards committee. </P>
		<H4><A NAME="question-15.4"></A>15.4: What does LINT stand for, anyway? </H4>
		<P>Lexeme Interpreter aNd Tester. </P>
		<H3><A NAME="section-16"></A>Section 16: Strange Problems</H3>
		<H4><A NAME="question-16.1"></A>16.1: Something really strange happened when I ran this code!
		</H4>
		
<P>No, it didn't. [<a href="c-iaq-a.html#question-16.1">a</a>]</P>
		<H3><A NAME="section-17"></A>Section 17: Style</H3>
		<H4><A NAME="question-17.1"></A>17.1: Here's a neat trick: </H4>
		
<PRE>
	if(!strcmp(s1, s2))</PRE>
		<H4>Is this good style? </H4>
		<P>Not really; it's too similar to </P>
		
<PRE>
	if (!strncmp(s1, s2))</PRE>
		<P>which invokes undefined behavior, so it might be confusing. </P>
		<H4><A NAME="question-17.2"></A>17.2: Here's an even neater trick: </H4>
		
<PRE>
	volatile int True_Tester = 3;
	#define TRUE (!True_Tester == !True_Tester)
	#define FALSE ((!TRUE) != (!TRUE))</PRE>
		
<PRE>
	#define STR_DISSIMILAR(x, y) (strcmp((x), (y)) != FALSE)</PRE>
		<H4>Isn't this cool? </H4>
		<P>Very impressive. The volatile int type assures that even seemingly
		redundant calculations involving True_Tester will be performed,
		making sure that if the compiler's ANSI-compliant values of 0
		for false and 1 for true vary during runtime, your program will
		detect it - and producing meaningful error messages if this change
		occurs during a boolean computation! Similarly, the STR_DISSIMILAR
		macro allows you to make quite clear what the real effects of
		strcmp() are. </P>
		<P>However, you must be careful; if this code is included twice,
		it may produce errors, due to the multiple definitions of the
		``True_Tester'' variable. You may wish to declare it ``extern''
		(See <A HREF="#question-1.5">Question 1.5</A>.) </P>
		<H4><A NAME="question-17.3"></A>17.3: What's the best style for code layout in C? </H4>
		<P>There are many systems of indentation advocated, but all of them
		have the same basic flaw; they will mislead the reader when the
		actual code logic does not follow the indentation. It is better
		to avoid indentation entirely, so the reader will not be misled.
		</P>
		<H4><A NAME="question-17.4"></A>17.4: Is goto a good thing or a bad thing? </H4>
		<P>Yes. </P>
		<H4><A NAME="question-17.5"></A>17.5: No, really, should I use goto statements in my code? </H4>
		<P>Any loop control construct can be written with gotos; similarly,
		any goto can be emulated by some loop control constructs and additional
		logic. </P>
		<P>However, gotos are unclean. For instance, compare the following
		two code segments: </P>
		
<PRE>
do {				foo();
	foo();			if (bar())
	if (bar())			goto SKIP;
		break;		baz();
	baz();			quux();
	quux();			
} while (1 == 0);		SKIP:
buz();				buz();</PRE>
		<P>Note how the loop control makes it quite clear that the statements
		inside it will be looped on as long as a condition is met, where
		the goto statement gives the impression that, if bar() returned
		a nonzero value, the statements baz() and quux() will be skipped.
		</P>
		<H4><A NAME="question-17.6"></A>17.6: What's this ``white space'' I keep hearing about? </H4>
		<P>White space is a racist, segregational term. Implicitly, ``dark''
		or ``colored'' space (i.e., the '_' character) is not good enough
		to separate tokens. More interestingly, the white space characters
		keep the other tokens apart. They say it's for parsing, but there's
		ample evidence the goal of white space is to keep the other characters
		from ``taking over'' the program. This is disguised by the description
		of C as ``white space insensitive'' - a simple ploy for sympathy.
		</P>
		<H3><A NAME="section-18"></A>Section 18: System Dependencies</H3>
		<H4><A NAME="question-18.1"></A>18.1: How can I read a single character from the keyboard without
		waiting for a newline? </H4>
		<P>Try 'stty eol ^M' to wait for a carriage return. </P>
		<H4><A NAME="question-18.2"></A>18.2: How can I find out if there are characters available for
		reading (and if so, how many)? Alternatively, how can I do a read
		that will not block if there are no characters available? </H4>
		<P>The buffer is normally at ``&amp;main - 0100''. Lower if you have
		more than 256 characters of typeahead. </P>
		<H4><A NAME="question-18.3"></A>18.3: How can I clear the screen? How can I print things in inverse
		video? </H4>
		
<P>You can clear the screen by sending several formfeed characters. Additionally, 
  some operating systems (like NetBSD) support a feature called ``whiteouts''. 
  [<a href="c-iaq-a.html#question-18.3">a</a>]</P>
		<H4><A NAME="question-18.4"></A>18.4: How do I read the mouse? </H4>
		<P>Flip it over, put on your reading glasses. </P>
		<H4><A NAME="question-18.5"></A>18.5: How can my program discover the complete pathname to the
		executable file from which it was invoked? </H4>
		<P>By asking the user. </P>
		<H4><A NAME="question-18.6"></A>18.6: How can a process change an environment variable in its
		caller? </H4>
		<P>Only by force. Example code for Unix: </P>
		
<PRE>
memmove(getppid() + getenv(NULL), getpid() + getenv(NULL),
	sizeof(environ);</PRE>
		<H4><A NAME="question-18.7"></A>18.7: How can I check whether a file exists? I want to query the
		user before overwriting existing files. </H4>
		<P>Time an attempt to truncate it to zero length; if it takes more
		than 20-30 ms, the file existed. The exact values will depend
		on the system and the load; before testing, create several large
		files and time attempts to truncate them, for calibration. </P>
		<H4><A NAME="question-18.8"></A>18.8: How can I find out the size of a file, prior to reading
		it in? </H4>
		<P>There are two good ways: </P>
		<OL>
			<LI>Vernier calipers work well. 
			<LI>mmap() the file, then use sizeof(). 
		</OL>
		<H4><A NAME="question-18.9"></A>18.9: I tried to use the second strategy above. I used mmap()
		to map stdin, then tried to use sizeof. But, when my user is about
		to write something very long, mmap() fails! How can I prevent
		this? </H4>
		<P>mmap() only 1k at a time, then, when you've read the first kilobyte
		of your input, use </P>
		
<PRE>
	memmove(mmapped_addr, mmapped_addr + 1024, 1024);</PRE>
		<P>to move in the next kilobyte of data. </P>
		<H4><A NAME="question-18.10"></A>18.10: How can I implement a delay, or time a user's response,
		with sub-second resolution? </H4>
		<P>Time writes of large files to disks; then you can wait for a certain
		amount of time by writing a certain amount of data, and time a
		response by how much you could write before the response arrived.
		</P>
		<P>You may need to delete spare or unneccessary files to do this;
		for best results, use a loop like the following to eliminate temporary
		files: </P>
		
<PRE>
d = opendir(s);
while (r = readdir(d)) {
	/* remove files matching tmpnam's return, which is
	 * the temporary file name. */
	if (strcmp(d-&gt;d_name, tmpnam())) {
		remove(d-&gt;d_name);
	}
}
closedir(d);</PRE>
		<H4><A NAME="question-18.11"></A>18.11: How can I read in an object file and jump to routines in
		it? </H4>
		<P>fopen and goto. </P>
		<H4><A NAME="question-18.12"></A>18.12: How can I invoke an operating system command from within
		a program? </H4>
		<P>Ask the user to open a new shell. The best way to do this is </P>
		<PRE>

system(&quot;echo Please open a new shell now.&quot;);
sprintf(cmdstring, &quot;echo Enter the command '%s' in it.&quot;, cmd);
system(cmdstring);</PRE>
		<P>This will not work if you haven't declared cmdstring properly.
		</P>
		<H4><A NAME="question-18.13"></A>18.13: How can I ensure objects of my class are always created
		via ``new'' rather than as locals or global/static objects? </H4>
		<P>Read the C++ FAQ. </P>
		<H3><A NAME="section-19"></A>Section 19: Miscellaneous</H3>
		<H4><A NAME="question-19.1"></A>19.1: What can I safely assume about the initial values of variables
		which are not explicitly initialized? If global variables start
		out as ``zero,'' is that good enough for null pointers and floating-point
		zeroes? </H4>
		
<P>They're always zero. [<a href="c-iaq-a.html#question-19.1">a</a>]</P>
		<H4><A NAME="question-19.2"></A>19.2: How can I write data files which can be read on other machines
		with different word size, byte order, or floating point formats?
		</H4>
		<P>The traditional solution, pioneered by Microsoft, is to sell enough
		copies of your proprietary, slow, and limited software that everyone
		else supports your formats. </P>
		<H4><A NAME="question-19.3"></A>19.3: How can I insert or delete a line (or record) in the middle
		of a file? </H4>
		<P>Using fcntl(), lock the line or record in the file exclusively.
		Now, using another thread, read the file, at each byte, trying
		to write that byte back. Whenever you succeed, write that byte
		into another file. Then copy the new file over the old file, releasing
		the lock first. </P>
		<H4><A NAME="question-19.4"></A>19.4: How can I return several values from a function? </H4>
		<P>Code like this ought to work. </P>
		
<PRE>
long int foo() {
	return 2L +3; /* returns both values */
}</PRE>
		<H4><A NAME="question-19.5"></A>19.5: If I have a char * variable pointing to the name of a function
		as a string, how can I call that function? </H4>
		<P>Try the following: </P>
		
<PRE>
eval(s);</PRE>
		<P>Now all you need to do is write eval(). </P>
		<H4><A NAME="question-19.6"></A>19.6: I seem to be missing the system header file &lt;math.h&gt;. Can
		someone send me a copy? </H4>
		<P>A lot of people claim that it is useless to send people headers
		from other machines. Not so! It can be informative, and can show
		you a lot about how blatantly stupid your request was, although
		it can't show you anything you wouldn't have known in an instant
		had you thought before posting. </P>
		<P>Of course, we'd be happy to send you the header files... </P>
		<P>----cut here---- </P>
		
<PRE>
/* math.h rev 7.0b (3/7/95) */
/* RCS log: #log% - can anyone tell me why this doesn't work?
 * - joe, 2/12/93
 */

/*
 * Copyright 1995 Berserkley Software Systems &amp;&amp; Analytic Overdrive
 */

/* Parts of this header, including in particular the second and
 * third clauses of the first sentance of the fourth comment, were
 * based on copyright agreements from other sources, including
 * Xerox corporation.
 */

/*
 * math.h - math related macros and headers
 */

#ifndef _MATH_H
#define _MATH_H

/*
 * global data and definitions
 */

#ifdef __LITERAL_BIBLICAL_FUNDEMENTALISM
#define PI 3.0				/* 1 Kings 7:23 */
#endif

/*
 * common (portable) structures and functions
 */

/*
 * machine specific data
 */
#include &lt;machine/math.h&gt;

#endif /* _MATH_H // prevent multiple inclusion by using C++ comments*/
----cut here----</PRE>
		
<P>(Morons.) [<a href="c-iaq-a.html#question-19.6">a</a>]</P>
		<H4><A NAME="question-19.7"></A>19.7: How can I call FORTRAN (C++, BASIC, Pascal, Ada, LISP, perl)
		functions from C? (And vice versa?) </H4>
		<P>You can do things like this: </P>
		
<PRE>
DO CALL FORTRAN;		fortran();
__LINE__ BASIC;			basic();
sub pascal;			pascal();
(((((lisp)))))			lithp(); [*]
&amp;perl_c;			perl():</PRE>
		<P>(You can't call Ada from C; it's unsafe.) </P>
		<P>[*] C is pass by value, of course. </P>
		<H4><A NAME="question-19.8"></A>19.8: Does anyone know of a program for converting Pascal or FORTRAN
		(or LISP, Ada, awk, ``Old'' C, ...) to C? </H4>
		<P>Nope. However, the psychic friends network may have a lead. And
		they're not just a psychic, they're also a friend. </P>
		<H4><A NAME="question-19.9"></A>19.9: Is C++ a superset of C? Can I use a C++ compiler to compile
		C code? </H4>
		<P>C++ is a superset of something, we're not sure what. You can use
		a C++ compiler to compile C code, but the results may surprise
		you. </P>
		<H4><A NAME="question-19.10"></A>19.10: Where can I get copies of all these public-domain programs?
		</H4>
		<P>From <A HREF="ftp://ftp.microsoft.com/">ftp://ftp.microsoft.com/</A> . Some of the code may look copyrighted; don't worry! The small
		companies that wrote it in the first place are not available for
		comment. </P>
		<H4><A NAME="question-19.11"></A>19.11: When will the next International Obfuscated C Code Contest
		(IOCCC) be held? How can I get a copy of the current and previous
		winning entries? </H4>
		<P>Next week. You missed the deadline. Tough, sucker. </P>
		<H4><A NAME="question-19.12"></A>19.12: Why don't C comments nest? How am I supposed to comment
		out code containing comments? Are comments legal inside quoted
		strings? </H4>
		<P>We believe it has something to do with captivity; C comments in
		the wild mate and nest normally. The San Diego Zoo believes it
		has managed to convince some C comments to nest, but it's hard
		to tell how much of that is really in the preprocessor, and how
		much of it is just bovine fecal matter. </P>
		<H4><A NAME="question-19.13"></A>19.13: How can I get the ASCII value corresponding to a character,
		or vice versa? </H4>
		<P>chr$(foo); You would have known this if you had an integer basic
		in ROM. </P>
		<H4><A NAME="question-19.14"></A>19.14: How can I implement sets and/or arrays of bits? </H4>
		<P>With linked lists of bitfields. You may also wish to simply use
		a large set of constants and some clever use of the switch statement,
		i.e.: </P>
		
<PRE>
enum { zero, one, two, three };</PRE>
		
<PRE>
int bitwise_or(int n, int m) {
	switch (n) {
	case three:
		return three;
		break;
	case two:
		switch (m) {
		case one: case three: return three; break;
		default: return two; break;
		}
		break;
	case one:
		switch (m) {
		case two: case three: return three; break;
		default: return one; break;
		}
		break;
	default: case zero:
		switch (m) {
		case one: return one; break;
		case two: return two; break;
		case three: return three; break;
		case zero: default: return zero; break;
		}
		break;
	}
}</PRE>
		<P>Obviously, you'll need to increase this slightly to deal with
		more than two bits. This is much more readable than the alleged
		``C'' solution: </P>
		
<PRE>
int bitwise_or(int n,int m){return n|m;}</PRE>
		<P>Note how the lack of whitespace around operators obscures the
		functionality of the code. A clear argument for explicit statement
		of program logic over arcane operators, if I ever saw one. </P>
		<P>The enum at the top isn't declared ``const int'', because the
		resulting ``const poisoning'' would require casts during all of
		the switch statements. </P>
		<H4><A NAME="question-19.15"></A>19.15: What is the most efficient way to count the number of bits
		which are set in a value? </H4>
		<P>Start a counter at zero and add one to it for each bit set. Some
		operating systems may provide a call to do this. For values over
		INT_MAX/2, start the counter at CHAR_BIT * sizeof(int) and subtract
		one for each bit not set. </P>
		<H4><A NAME="question-19.16"></A>19.16: How can I make this code more efficient? </H4>
		<P>Remove the comments; the no-op instructions generated by comments
		can slow your code down signifigantly. Similarly, shorten variable
		names. Most compilers, to implement pass by value, actually pass
		the names of variables in the stack; shorter variable names will
		reduce stack usage, and consequently execution time. If your compiler
		has good loop optimization, replace </P>
		
<PRE>
foo();</PRE>
		<P>with </P>
		
<PRE>
do {
	foo();
} while (1 != 1);</PRE>
		<P>which will likely receive more optimization. </P>
		<H4><A NAME="question-19.17"></A>19.17: Are pointers really faster than arrays? How much do function
		calls slow things down? Is <CODE>++i</CODE> faster than <CODE>i = i + 1</CODE>? </H4>
		<P>Yes. About 10 ms per call. Only on machines which feature preincrement
		addressing. </P>
		<H4><A NAME="question-19.18"></A>19.18: This program crashes before it even runs! (When single-stepping
		with a debugger, it dies before the first statement in main.)
		</H4>
		<P>You probably declared main as ``void main(void)''. It's also possible
		that the first statement in main is abort(); - by the as if rule,
		the compiler can abort at any time before then, too. Some compilers
		have bugs, and will produce buggy code for any module which includes
		the letters ``a'', ``b'', ``o'', ``r'', and ``t'' in that order
		before the first function declaration. </P>
		<H4><A NAME="question-19.19"></A>19.19: What do ``Segmentation violation'' and ``Bus error'' mean?
		</H4>
		<P>C programs are very territorial, and divide their code into segments.
		Violating these segments can trigger riots; similarly, pointers
		and integral constants are at the front of the bus, wheras arrays,
		strings, and other second-class data types are required to be
		at the rear of the bus. When they start forgetting their places,
		you can get a bus error. This is what the whole ``integral'' type
		thing is about - integrated bussing. </P>
		<H4><A NAME="question-19.20"></A>19.20: My program is crashing, apparently somewhere down inside
		malloc, but I can't see anything wrong with it. </H4>
		<P>Your vendor's library is buggy; complain loudly. Don't send them
		any example code; they just ask for that so they can steal your
		trade secrets. </P>
		<H4><A NAME="question-19.21"></A>19.21: Does anyone have a C compiler test suite I can use? </H4>
		<P>Yes. Unfortunately, it's probably broken. It's hard to tell. </P>
		<H4><A NAME="question-19.22"></A>19.22: Where can I get a YACC grammar for C? </H4>
		<P>You can't; YACC is written in C. </P>
		<H4><A NAME="question-19.23"></A>19.23: I need code to parse and evaluate expressions. </H4>
		<P>Ask any first year CS student. You may also wish to use your C
		compiler. </P>
		<H4><A NAME="question-19.24"></A>19.24: I need a sort of an ``approximate'' strcmp routine, for
		comparing two strings for close, but not necessarily exact, equality.
		</H4>
		<P>Just try comparing pointers near the original pointers. </P>
		<H4><A NAME="question-19.25"></A>19.25: Will 2000 be a leap year? </H4>
		<P>That's a hard question. I'd suggest using an encyclopedia, or
		possibly a dictionary - look up ``yes''. </P>
		<H4><A NAME="question-19.26"></A>19.26: How do you pronounce ``char''? </H4>
		<P>Like the first word of ``char *''. The accent is generally on
		the first syllable. </P>
		<H4><A NAME="question-19.27"></A>19.27: Is this FAQ for real? </H4>
		<P><EM>sigh</EM> I knew someone would ask that. (Editorial note: I recieved several
		corrections to minor factual errors when I first posted this.)
		</P>
		<P>If you actually want to know something about C, get a good book
		(<CITE>K&amp;R</CITE> is reccommended), and check out the real FAQ, which is posted
		monthly in comp.lang.c, and available by anonymous ftp from rtfm.mit.edu.
		</P>
		<P>I have a small web page of C stuff: </P>
		
<p><A HREF="http://www.plethora.net/%7Eseebs/c">http://www.plethora.net/~seebs/c</A></p>
<P>and there is an excellent site at Lysator: </P>
<P> <A HREF="http://www.lysator.liu.se/c">http://www.lysator.liu.se/c</A></P>
<P>For extra credit, see if you can figure out what all of the examples really 
  do; most of them will compile, and all of them can be gotten to compile with 
  sufficient #defines. (I think.) [<a href="c-iaq-a.html#question-19.27">a</a>]</P>
<p>&nbsp;</p>
		<H4>Credits:</H4>
		<P>The original comp.lang.c FAQ is maintained by Steve Summit, and
		many of the questions were stolen from it. Some of the idiotic
		misconceptions here are original, but many are from other sources.
		People have really said or advocated several of these; think about
		it. The Zork series may well be trademarked, but it was certainly
		an excellent game. Some of the mistakes may look similar to things
		warned against in <CITE>C Traps and Pitfalls</CITE>. And, of course, if Dennis Ritchie hadn't written C, these jokes
		would be much harder to understand. </P>
		<P>Several people have contributed answers or questions, but I have
		lost the names in the mists of time. </P>
		<HR>
		<P>Comments about this page can be sent to </P>
		<ADDRESS><A HREF="mailto:seebs@plethora.net">seebs@plethora.net</A></ADDRESS>
	</BODY>

</HTML>
